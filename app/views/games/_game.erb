<%= turbo_frame_tag game, class: "flex flex-col h-full" do %>
  <div class="p-4 mh-4">
    <div class="text-center text-lg font-semibold tracking-widest text-gray-900 uppercase rounded-lg dark-mode:text-white focus:outline-none focus:shadow-outline">
      <%= game.title %>
    </div>
    <div class="flex w-full space-x-4 items-stretch place-content-between">
      <%if game.create_user_id == user&.id %>
        <%= link_to 'Edit', edit_game_path(game), class: 'w-auto p-4 bg-gradient-to-tr from-amber-600 to-amber-300 text-indigo-100 py-2 rounded-md text-lg tracking-wide' %>
      <% end %>
      <% if player&.is_ready? %>
        <div class="w-auto p-4 bg-gradient-to-tr from-zinc-400 to-zinc-350 py-2 rounded-md text-lg tracking-wide">
          Start
        </div>
      <% else %>
        <%= link_to 'Start', get_ready_players_path(game_id: game.id), class: 'w-auto p-4 bg-gradient-to-tr from-blue-600 to-indigo-600 text-indigo-100 py-2 rounded-md text-lg tracking-wide' %>
      <% end %>
      <%= link_to 'Leave', player_path(player), class: 'w-auto p-4 bg-gradient-to-tr from-red-600 to-red-300 text-indigo-100 py-2 rounded-md text-lg tracking-wide', data: { turbo_method: :delete } %>
    </div>
  </div>
  <div class="grid grid-cols-2 gap-4 h-3/6">
    <div class="flex flex-col overflow-y-auto">
      <% if game.is_started? %>
        <div class="flex flex-col">
          <% if player&.is_spy? %>
            <div class="w-full max-w-2xl mx-auto bg-white shadow-lg rounded-sm border border-gray-200">
              <header class="px-5 py-4 border-b border-gray-100">
                <h2 class="font-semibold text-gray-800 text-center">
                  <span>
                    You are SPY
                  </span>
                </h2>
              </header>
            </div>
            <div class="w-full max-w-2xl mx-auto bg-white shadow-lg rounded-sm border border-gray-200">
              <header class="px-5 py-4 border-b border-gray-100">
                <h2 class="font-semibold text-gray-800 text-center">
                  <span>
                    Guess place
                  </span>
                </h2>
              </header>
            </div>
            <% Place.all.each do |place| %>
              <%= link_to "#{place.name}", guess_place_game_path(id: game.id, place_id: place.id), class: 'text-center w-auto p-4 bg-gradient-to-tr from-blue-600 to-indigo-600 text-indigo-100 py-2 rounded-md text-lg tracking-wide mb-1' %>
            <% end %>
          <% else %>
            <div class="w-full max-w-2xl mx-auto bg-white shadow-lg rounded-sm border border-gray-200">
              <header class="px-5 py-4 border-b border-gray-100">
                <h2 class="font-semibold text-gray-800 text-center">
                  <span>
                    You are in/on:
                  </span>
                  <span class="w-auto p-4 bg-gradient-to-tr from-blue-600 to-indigo-600 text-indigo-100 py-2 rounded-md text-lg tracking-wide mb-1">
                    <%= game.current_place.name %>
                  </span>
                </h2>
              </header>
            </div>
            <div class="w-full max-w-2xl mx-auto bg-white shadow-lg rounded-sm border border-gray-200">
              <header class="px-5 py-4 border-b border-gray-100">
                <h2 class="font-semibold text-gray-800 text-center">
                  <span>
                    Vote for spy:
                  </span>
                </h2>
              </header>
            </div>
            <% Player.where.not(id: player.id).each do |player| %>
              <%= link_to "#{player.full_name}", vote_for_spy_game_path(id: game.id, spy_id: player.id), class: 'text-center w-auto p-4 bg-gradient-to-tr from-blue-600 to-indigo-600 text-indigo-100 py-2 rounded-md text-lg tracking-wide mb-1' %>
            <% end %>
          <% end %>
        </div>
      <% end %>
    </div>

    <div class="w-full max-w-2xl mx-auto bg-white shadow-lg rounded-sm border border-gray-200">
      <header class="px-5 py-4 border-b border-gray-100">
        <h2 class="font-semibold text-gray-800">Scoreboard</h2>
      </header>
      <div class="p-3">
        <div class="overflow-x-auto">
          <table class="table-auto w-full">
            <thead class="text-xs font-semibold uppercase text-gray-400 bg-gray-50">
              <tr>
                <th class="p-2 whitespace-nowrap">
                  <div class="font-semibold text-left">Place</div>
                </th>
                <th class="p-2 whitespace-nowrap">
                  <div class="font-semibold text-left">Score</div>
                </th>
                <th class="p-2 whitespace-nowrap">
                  <div class="font-semibold text-left">Name</div>
                </th>
              </tr>
            </thead>
            <tbody class="text-sm divide-y divide-gray-100">
              <% game.players.order(score: :desc).each_with_index do |player, index| %>
                <tr>
                  <td class="p-2 whitespace-nowrap">
                    <div class="text-left"><%= index + 1 %></div>
                  </td>
                  <td class="p-2 whitespace-nowrap">
                    <div class="text-left font-medium text-green-500"><%= player.score %></div>
                  </td>
                  <td class="p-2 whitespace-nowrap">
                    <div class="text-lg text-left"><%= player.full_name %></div>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
<% end %>
